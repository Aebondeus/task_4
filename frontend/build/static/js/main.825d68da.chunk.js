(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{34:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),s=n(20),a=n.n(s),o=(n(26),n(2)),i=n(7),l=n.n(i),j=n(9),d=n(12),b=n(10),u=n(4),h=Object(c.createContext)({token:null,id:null,login:function(){},logout:function(){}}),O=function(){var e=Object(c.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(null),a=Object(u.a)(s,2),o=a[0],i=a[1];return{loading:n,request:Object(c.useCallback)(function(){var e=Object(j.a)(l.a.mark((function e(t){var n,c,s,a,o,j=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=j.length>1&&void 0!==j[1]?j[1]:"GET",c=j.length>2&&void 0!==j[2]?j[2]:null,s=j.length>3&&void 0!==j[3]?j[3]:{},r(!0),e.prev=4,c&&(c=JSON.stringify(c),s["Content-Type"]="application/json"),e.next=8,fetch(t,{method:n,body:c,headers:s});case 8:return a=e.sent,e.next=11,a.json();case 11:if(o=e.sent,a.ok){e.next=15;break}throw console.log("!response.ok",a.status),new Error(o.message);case 15:return r(!1),e.abrupt("return",o);case 19:throw e.prev=19,e.t0=e.catch(4),r(!1),console.log("Well we catch an error"),i(e.t0.message),e.t0;case 25:case"end":return e.stop()}}),e,null,[[4,19]])})));return function(t){return e.apply(this,arguments)}}(),[]),error:o,clearError:function(){return i(null)}}},g=n(0),p=function(){var e=O(),t=e.loading,n=e.request,r=(e.error,Object(c.useState)({login:"",password:""})),s=Object(u.a)(r,2),a=s[0],o=s[1],i=Object(c.useContext)(h),p=function(e){o(Object(b.a)(Object(b.a)({},a),{},Object(d.a)({},e.target.name,e.target.value)))},x=function(){var e=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n("/auth/login/","POST",Object(b.a)({},a));case 3:t=e.sent,i.login(t.token,t.id),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Error in login page");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{className:"header",children:Object(g.jsx)("div",{className:"headerLogo",children:"Login Page"})}),Object(g.jsx)("div",{className:"form-wrapper",children:Object(g.jsxs)("form",{children:[Object(g.jsx)("div",{className:"row justify-content-center",children:Object(g.jsxs)("div",{className:"form-group col-lg-5",children:[Object(g.jsx)("label",{children:"Login: "}),Object(g.jsx)("input",{name:"login",type:"text",onChange:p,className:"form-control",id:"login","aria-describedby":"login"})]})}),Object(g.jsx)("div",{className:"row justify-content-center",children:Object(g.jsxs)("div",{className:"form-group col-lg-5",children:[Object(g.jsx)("label",{name:"password",children:"Password: "}),Object(g.jsx)("input",{name:"password",type:"password",className:"form-control",id:"password",onChange:p})]})}),Object(g.jsxs)("div",{className:"row justify-content-center mt-1",children:[Object(g.jsx)("button",{className:"btn btn-primary",disabled:t,onClick:x,children:"Submit"}),Object(g.jsx)("div",{className:"regLink",children:Object(g.jsx)("a",{href:"/register",children:"Register"})})]})]})})]})},x=function(){var e=O(),t=e.loading,n=e.request,r=(e.error,Object(c.useState)({login:"",password:"",email:""})),s=Object(u.a)(r,2),a=s[0],i=s[1],h=Object(o.g)(),p=function(e){i(Object(b.a)(Object(b.a)({},a),{},Object(d.a)({},e.target.name,e.target.value)))},x=function(){var e=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n("/auth/register","POST",Object(b.a)({},a));case 3:e.sent,h.push("/login"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Error in register");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{className:"header",children:Object(g.jsx)("div",{className:"headerLogo",children:"Registration Page"})}),Object(g.jsx)("div",{className:"form-wrapper",children:Object(g.jsxs)("form",{children:[Object(g.jsx)("div",{className:"row justify-content-center",children:Object(g.jsxs)("div",{className:"form-group col-lg-5",children:[Object(g.jsx)("label",{name:"login",children:"Login: "}),Object(g.jsx)("input",{name:"login",type:"text",className:"form-control",id:"login","aria-describedby":"login",onChange:p})]})}),Object(g.jsx)("div",{className:"row justify-content-center",children:Object(g.jsxs)("div",{className:"form-group col-lg-5",children:[Object(g.jsx)("label",{name:"password",children:"Password: "}),Object(g.jsx)("input",{name:"password",type:"password",className:"form-control",id:"password",onChange:p})]})}),Object(g.jsx)("div",{className:"row justify-content-center",children:Object(g.jsxs)("div",{className:"form-group col-lg-5",children:[Object(g.jsx)("label",{name:"email",children:"Email: "}),Object(g.jsx)("input",{name:"email",type:"text",className:"form-control",id:"email",onChange:p})]})}),Object(g.jsx)("div",{className:"row justify-content-center mt-1",children:Object(g.jsx)("button",{type:"submit",onClick:x,disabled:t,className:"btn btn-primary",children:"Submit"})})]})})]})};var m=function(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),r=n[0],s=n[1],a=O().request;function o(){for(var e=[],t=0;t<r.length;t++)r[t].blocked&&e.push(r[t].id);return e}Object(c.useEffect)((function(){s(e.users.map((function(e){return{id:e.id,blocked:!1}})))}),[e.users]);var i={toolbar:{display:"flex",alignItems:"center",marginBottom:"1rem"},btn:{marginRight:"5px"}};return Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{className:"toolbar justify-content-center",style:i.toolbar,children:[Object(g.jsx)("button",{type:"button",className:"btn btn-secondary",style:i.btn,onClick:function(){var e=o();a("/api/table/changest","PUT",{status:!0,id:e}),window.location.reload(!1)},children:"Block"}),Object(g.jsx)("button",{type:"button",className:"btn btn-success",style:i.btn,onClick:function(){var e=o();a("/api/table/changest","PUT",{status:!1,id:e}),window.location.reload(!1)},children:"Unblock"}),Object(g.jsx)("button",{type:"button",className:"btn btn-danger",style:i.btn,onClick:function(){var e=o();a("/api/table/changest/","DELETE",{id:e}),window.location.reload(!1)},children:"Delete"})]}),Object(g.jsxs)("table",{className:"table",children:[Object(g.jsx)("thead",{children:Object(g.jsxs)("tr",{children:[Object(g.jsx)("th",{scope:"col",children:Object(g.jsx)("input",{type:"checkbox",onChange:function(e){s(r.map((function(t){return t.blocked=e.target.checked,t})))}})}),Object(g.jsx)("th",{scope:"col",children:"id"}),Object(g.jsx)("th",{scope:"col",children:"Login"}),Object(g.jsx)("th",{scope:"col",children:"Email"}),Object(g.jsx)("th",{scope:"col",children:"Registration date"}),Object(g.jsx)("th",{scope:"col",children:"Last Login"}),Object(g.jsx)("th",{scope:"col",children:"Status"})]})}),Object(g.jsx)("tbody",{children:e.users.map((function(e,t){return Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{children:Object(g.jsx)("input",{type:"checkbox",onChange:function(t){s(r.map((function(n){return n.id===e.id&&(n.blocked=t.target.checked),n})))},checked:r.length>0&&r[t].blocked})}),Object(g.jsx)("td",{children:e.id}),Object(g.jsx)("td",{children:e.login}),Object(g.jsx)("td",{children:e.email}),Object(g.jsx)("td",{children:e.regData}),Object(g.jsx)("td",{children:e.lastLogin}),Object(g.jsx)("td",{children:e.blocked?"Blocked":"Free as a bird"})]},e.id)}))})]})]})},f=function(){var e=Object(c.useState)([]),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(c.useContext)(h),a=O().request;return Object(c.useEffect)((function(){(function(){var e=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a("/api/table","PUT",{id:s.id});case 2:e.sent.blocked?s.logout():fetch("/api/table").then((function(e){return e.json()})).then((function(e){setTimeout((function(){r(e)}),100)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(g.jsx)("div",{children:Object(g.jsxs)("div",{className:"header",children:[Object(g.jsx)("div",{className:"headerLogo",children:"List of Registered Users"}),Object(g.jsx)(m,{users:n})]})})},v="storage";var k=function(){var e=function(){var e=Object(c.useState)(null),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(null),a=Object(u.a)(s,2),o=a[0],i=a[1],l=Object(c.useCallback)((function(e,t){r(e),i(t),localStorage.setItem(v,JSON.stringify({userId:t,token:e}))}),[n,o]),j=Object(c.useCallback)((function(){r(null),i(null),localStorage.removeItem(v)}),[]);return Object(c.useEffect)((function(){var e=JSON.parse(localStorage.getItem(v));e&&e.token&&l(e.token,e.userId)}),[]),{login:l,logout:j,token:n,id:o}}(),t=e.login,n=e.logout,r=e.token,s=e.id;console.log("Token: ",r,"Id: ",s);var a=!!r?Object(g.jsxs)(o.d,{children:[Object(g.jsx)(o.b,{path:"/main",component:f,exact:!0}),Object(g.jsx)(o.a,{to:"/main"})]}):Object(g.jsxs)(o.d,{children:[Object(g.jsx)(o.b,{path:"/login",component:p,exact:!0}),Object(g.jsx)(o.b,{path:"/register",component:x,exact:!0}),Object(g.jsx)(o.a,{to:"/login"})]});return Object(g.jsx)(h.Provider,{value:{token:r,id:s,login:t,logout:n},children:Object(g.jsx)("div",{className:"container",children:a})})},w=(n(34),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),s(e),a(e)}))}),y=n(14);a.a.render(Object(g.jsx)(r.a.StrictMode,{children:Object(g.jsx)(y.a,{children:Object(g.jsx)(k,{})})}),document.getElementById("root")),w()}},[[35,1,2]]]);
//# sourceMappingURL=main.825d68da.chunk.js.map