(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{34:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),s=n(20),o=n.n(s),a=(n(26),n(2)),l=n(7),i=n.n(l),j=n(9),d=n(12),b=n(10),u=n(4),h=Object(c.createContext)({token:null,id:null,login:function(){},logout:function(){}}),O=function(){var e=Object(c.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(null),o=Object(u.a)(s,2),a=o[0],l=o[1];return{loading:n,request:Object(c.useCallback)(function(){var e=Object(j.a)(i.a.mark((function e(t){var n,c,s,o,a,j=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=j.length>1&&void 0!==j[1]?j[1]:"GET",c=j.length>2&&void 0!==j[2]?j[2]:null,s=j.length>3&&void 0!==j[3]?j[3]:{},r(!0),e.prev=4,console.log(c),c&&(c=JSON.stringify(c),s["Content-Type"]="application/json"),e.next=9,fetch(t,{method:n,body:c,headers:s});case 9:return o=e.sent,e.next=12,o.json();case 12:if(a=e.sent,o.ok){e.next=16;break}throw console.log("!response.ok",o.status),new Error(a.message);case 16:return console.log("Seems to be good..."),r(!1),e.abrupt("return",a);case 21:throw e.prev=21,e.t0=e.catch(4),r(!1),console.log("Well we catch an error"),l(e.t0.message),e.t0;case 27:case"end":return e.stop()}}),e,null,[[4,21]])})));return function(t){return e.apply(this,arguments)}}(),[]),error:a,clearError:function(){return l(null)}}},g=n(0),x=function(){var e=O(),t=e.loading,n=e.request,r=(e.error,Object(c.useState)({login:"",password:""})),s=Object(u.a)(r,2),o=s[0],a=s[1],l=Object(c.useContext)(h),x=function(e){a(Object(b.a)(Object(b.a)({},o),{},Object(d.a)({},e.target.name,e.target.value)))},m=function(){var e=Object(j.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n("/auth/login/","POST",Object(b.a)({},o));case 3:t=e.sent,console.log("Data: ",t),console.log("Login with this id and token",t.token,t.id),l.login(t.token,t.id),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("Error in login page");case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{className:"header",children:Object(g.jsx)("div",{className:"headerLogo",children:"Login Page"})}),Object(g.jsx)("div",{className:"form-wrapper",children:Object(g.jsxs)("form",{children:[Object(g.jsx)("div",{className:"row justify-content-center",children:Object(g.jsxs)("div",{className:"form-group col-lg-5",children:[Object(g.jsx)("label",{children:"Login: "}),Object(g.jsx)("input",{name:"login",type:"text",onChange:x,className:"form-control",id:"login","aria-describedby":"login"})]})}),Object(g.jsx)("div",{className:"row justify-content-center",children:Object(g.jsxs)("div",{className:"form-group col-lg-5",children:[Object(g.jsx)("label",{name:"password",children:"Password: "}),Object(g.jsx)("input",{name:"password",type:"password",className:"form-control",id:"password",onChange:x})]})}),Object(g.jsxs)("div",{className:"row justify-content-center mt-1",children:[Object(g.jsx)("button",{className:"btn btn-primary",disabled:t,onClick:m,children:"Submit"}),Object(g.jsx)("div",{className:"regLink",children:Object(g.jsx)("a",{href:"/register",children:"Register"})})]})]})})]})},m=function(){var e=O(),t=e.loading,n=e.request,r=(e.error,Object(c.useState)({login:"",password:"",email:""})),s=Object(u.a)(r,2),o=s[0],l=s[1],h=Object(a.g)(),x=function(e){l(Object(b.a)(Object(b.a)({},o),{},Object(d.a)({},e.target.name,e.target.value)))},m=function(){var e=Object(j.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n("/auth/register","POST",Object(b.a)({},o));case 3:t=e.sent,console.log("Data :",t),h.push("/login"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Error in register");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{className:"header",children:Object(g.jsx)("div",{className:"headerLogo",children:"Registration Page"})}),Object(g.jsx)("div",{className:"form-wrapper",children:Object(g.jsxs)("form",{children:[Object(g.jsx)("div",{className:"row justify-content-center",children:Object(g.jsxs)("div",{className:"form-group col-lg-5",children:[Object(g.jsx)("label",{name:"login",children:"Login: "}),Object(g.jsx)("input",{name:"login",type:"text",className:"form-control",id:"login","aria-describedby":"login",onChange:x})]})}),Object(g.jsx)("div",{className:"row justify-content-center",children:Object(g.jsxs)("div",{className:"form-group col-lg-5",children:[Object(g.jsx)("label",{name:"password",children:"Password: "}),Object(g.jsx)("input",{name:"password",type:"password",className:"form-control",id:"password",onChange:x})]})}),Object(g.jsx)("div",{className:"row justify-content-center",children:Object(g.jsxs)("div",{className:"form-group col-lg-5",children:[Object(g.jsx)("label",{name:"email",children:"Email: "}),Object(g.jsx)("input",{name:"email",type:"text",className:"form-control",id:"email",onChange:x})]})}),Object(g.jsx)("div",{className:"row justify-content-center mt-1",children:Object(g.jsx)("button",{type:"submit",onClick:m,disabled:t,className:"btn btn-primary",children:"Submit"})})]})})]})};var p=function(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),r=n[0],s=n[1],o=O().request;function a(){for(var e=[],t=0;t<r.length;t++)r[t].blocked&&e.push(r[t].id);return e}Object(c.useEffect)((function(){s(e.users.map((function(e){return{id:e.id,blocked:!1}})))}),[e.users]);var l={toolbar:{display:"flex",alignItems:"center",marginBottom:"1rem"},btn:{marginRight:"5px"}};return Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{className:"toolbar justify-content-center",style:l.toolbar,children:[Object(g.jsx)("button",{type:"button",className:"btn btn-secondary",style:l.btn,onClick:function(){var e=a();o("/table/changest","PUT",{status:!0,id:e}),window.location.reload(!1)},children:"Block"}),Object(g.jsx)("button",{type:"button",className:"btn btn-success",style:l.btn,onClick:function(){var e=a();o("/table/changest","PUT",{status:!1,id:e}),window.location.reload(!1)},children:"Unblock"}),Object(g.jsx)("button",{type:"button",className:"btn btn-danger",style:l.btn,onClick:function(){var e=a();o("/table/changest/","DELETE",{id:e}),window.location.reload(!1)},children:"Delete"})]}),Object(g.jsxs)("table",{className:"table",children:[Object(g.jsx)("thead",{children:Object(g.jsxs)("tr",{children:[Object(g.jsx)("th",{scope:"col",children:Object(g.jsx)("input",{type:"checkbox",onChange:function(e){s(r.map((function(t){return t.blocked=e.target.checked,t})))}})}),Object(g.jsx)("th",{scope:"col",children:"id"}),Object(g.jsx)("th",{scope:"col",children:"Login"}),Object(g.jsx)("th",{scope:"col",children:"Email"}),Object(g.jsx)("th",{scope:"col",children:"Registration date"}),Object(g.jsx)("th",{scope:"col",children:"Last Login"}),Object(g.jsx)("th",{scope:"col",children:"Status"})]})}),Object(g.jsx)("tbody",{children:e.users.map((function(e,t){return Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{children:Object(g.jsx)("input",{type:"checkbox",onChange:function(t){s(r.map((function(n){return n.id===e.id&&(n.blocked=t.target.checked),n})))},checked:r.length>0&&r[t].blocked})}),Object(g.jsx)("td",{children:e.id}),Object(g.jsx)("td",{children:e.login}),Object(g.jsx)("td",{children:e.email}),Object(g.jsx)("td",{children:e.regData}),Object(g.jsx)("td",{children:e.lastLogin}),Object(g.jsx)("td",{children:e.blocked?"Blocked":"Free as a bird"})]},e.id)}))})]})]})},f=function(){var e=Object(c.useState)([]),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(c.useContext)(h),o=O().request;return Object(c.useEffect)((function(){(function(){var e=Object(j.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Only one?",s.id),e.next=3,o("/table","PUT",{id:s.id});case 3:e.sent.blocked?s.logout():fetch("/table").then((function(e){return e.json()})).then((function(e){setTimeout((function(){r(e)}),100)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(g.jsx)("div",{children:Object(g.jsxs)("div",{className:"header",children:[Object(g.jsx)("div",{className:"headerLogo",children:"List of Registered Users"}),Object(g.jsx)(p,{users:n})]})})},v="storage";var k=function(){var e=function(){var e=Object(c.useState)(null),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(null),o=Object(u.a)(s,2),a=o[0],l=o[1],i=Object(c.useCallback)((function(e,t){console.log("INIT CALLBACK: ",e,t),r(e),l(t),console.log("OUR TOKEN AND ID IN STATE: ",n,a),localStorage.setItem(v,JSON.stringify({userId:t,token:e}))}),[n,a]),j=Object(c.useCallback)((function(){r(null),l(null),localStorage.removeItem(v)}),[]);return Object(c.useEffect)((function(){var e=JSON.parse(localStorage.getItem(v));e&&e.token&&i(e.token,e.userId)}),[]),console.log("BEFORE RETURN, TOKEN: ",n,"ID: ",a),{login:i,logout:j,token:n,id:a}}(),t=e.login,n=e.logout,r=e.token,s=e.id;console.log("Token: ",r,"Id: ",s);var o=!!r?Object(g.jsxs)(a.d,{children:[Object(g.jsx)(a.b,{path:"/table",component:f,exact:!0}),Object(g.jsx)(a.a,{to:"/table"})]}):Object(g.jsxs)(a.d,{children:[Object(g.jsx)(a.b,{path:"/login",component:x,exact:!0}),Object(g.jsx)(a.b,{path:"/register",component:m,exact:!0}),Object(g.jsx)(a.a,{to:"/login"})]});return Object(g.jsx)(h.Provider,{value:{token:r,id:s,login:t,logout:n},children:Object(g.jsx)("div",{className:"container",children:o})})},N=(n(34),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),c(e),r(e),s(e),o(e)}))}),w=n(14);o.a.render(Object(g.jsx)(r.a.StrictMode,{children:Object(g.jsx)(w.a,{children:Object(g.jsx)(k,{})})}),document.getElementById("root")),N()}},[[35,1,2]]]);
//# sourceMappingURL=main.73524167.chunk.js.map